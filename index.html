<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Title</title>
    <link rel="manifest" href="/manifest.json"/>
    <link rel="stylesheet" href="/css/main1.css"/>
    <link rel="apple-touch-icon" href="/icon1.png">
    <script type="text/javascript" src="/js/index.js"></script>
</head>
<body>
<div id="offline" style="display:none">离线</div>
<script>
    var offline = document.getElementById("offline");
    function showIndicator() {
        offline.innerHTML = "离线"
        offline.style.display = "block"
        Notification.requestPermission().then(grant =>{
            if(grant != "granted"){
                return;
            }
            const notification = new Notification("Hi,网络不给力",{
                body: "您的网络貌似离线了，不过在志文工作室里访问过的页面还可以继续打开~",
                icon: 'https://wwwupload.gaodunwangxiao.com/uploads/180126/5931-1P126153351949.jpg'
            })
            notification.onclick = ()=>{
                notification.close();
            }
        })
    }
    function hideIndicator() {
        offline.style.display = "none"
    }
    window.addEventListener("online",hideIndicator);
    window.addEventListener("offline",showIndicator);
    self.onerror = (errorMessage, scriptURI, lineNumber, columnNumber, error)=>{
        debugger;
    }
</script>
<h1>Hello World 132</h1>
<img src="https://wwwupload.gaodunwangxiao.com/images/rgtConsult.png"/>
<img src="https://wwwupload.gaodunwangxiao.com/uploads/180126/5931-1P126153351949.jpg" style="display:none"/>
<script>
    var version = '1.0.222111';
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function () {
            navigator.serviceWorker.register('/sw.js', {scope: '/'})
                .then(function (registration) {
                    if (localStorage.getItem('sw_version') !== version) {
                        registration.update().then(function () {
                            localStorage.setItem('sw_version', version)
                        });
                    }
                    // 注册成功
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                })
                .catch(function (err) {
                    // 注册失败:(
                    console.log('ServiceWorker registration failed: ', err);
                });
        });
    }

</script>
</body>
</html>